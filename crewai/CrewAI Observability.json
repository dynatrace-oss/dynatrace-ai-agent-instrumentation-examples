{"version":20,"variables":[{"version":2,"key":"CrewName","type":"query","visible":true,"editable":true,"input":"fetch spans\n| filter isNotNull(crewai.crew.name)\n| fields `Crew Name` = crewai.crew.name\n| dedup `Crew Name`","multiple":true,"defaultValue":["3420b2ac-f1cf-4b24-b62d-61ba1ba8ed05*"]},{"version":2,"key":"FlowName","type":"query","visible":true,"editable":true,"input":"fetch spans\n| filter isNotNull(flow_name)\n| fields flow_name\n| dedup flow_name","multiple":true,"defaultValue":["3420b2ac-f1cf-4b24-b62d-61ba1ba8ed05*"]}],"tiles":{"0":{"title":"Active Crews","type":"data","query":"fetch spans\n| filter isNotNull(crewai.crew.name)\n| summarize countDistinct(crewai.crew.name)","visualization":"singleValue","visualizationSettings":{"singleValue":{"labelMode":"none"},"autoSelectVisualization":false},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"1":{"title":"Active Crews","type":"data","query":"fetch spans\n| filter isNotNull(crewai.crew.name)\n| fields `Crew Name` = crewai.crew.name\n| dedup `Crew Name`","visualization":"table","visualizationSettings":{"table":{"hideColumnsForLargeResults":false},"autoSelectVisualization":false},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"2":{"title":"Crew Execution Log","type":"data","query":"fetch spans\n| filter isNotNull(crewai.crew.name)\n| filter in(crewai.crew.name, $CrewName)\n| fieldsRemove span.id, dt.ingest.size, dt.retain.size, crewai.crew.before_kickoff_callbacks, crewai.crew.after_kickoff_callbacks,\n  crewai.crew.execution_logs, supportability.endpoint_name_rule, dt.openpipeline.pipelines, request.is_root_span,\n  otel.scope.name, otel.scope.version, dt.failure_detection.ruleset_id, endpoint.name, span.kind, dt.openpipeline.source,\n  crewai.crew.security_config, dt.entity.service,crewai.crew.output_log_file,\n  crewai.crew.tracing, crewai.crew.share_crew\n//| parse crewai.crew.token_usage, \"\"\"total_tokens= INT:total_tokens\"\"\"\n// total_tokens=979 prompt_tokens=243 cached_prompt_tokens=0 completion_tokens=736 successful_requests=1\n| parse crewai.crew.token_usage, \"'total_tokens=' INT:total_tokens SPACE 'prompt_tokens=' INT:prompt_tokens SPACE 'cached_prompt_tokens=' INT:cached_prompt_tokens SPACE 'completion_tokens=' INT:completion_tokens SPACE 'successful_requests=' INT:successful_requests\"\n| fieldsRemove crewai.crew.token_usage, crewai.crew.parent_flow\n//| fields `Crew Name` = crewai.crew.name\n| sort end_time desc","visualization":"table","visualizationSettings":{"autoSelectVisualization":true,"table":{"hideColumnsForLargeResults":true,"sortBy":[{"columnId":"[\"start_time\"]","direction":"descending"}],"columnWidths":{"[\"span.status_message\"]":613}},"thresholds":[]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"3":{"title":"Time Spent Per Agent","type":"data","query":"fetch spans\n| filter traceloop.span.kind == \"task\"\n| summarize sum(duration), by: {crewai.task.agent}","visualization":"categoricalBarChart","visualizationSettings":{"chartSettings":{"categoricalBarChartSettings":{"layout":"vertical"}},"autoSelectVisualization":false},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"4":{"title":"Executions Per Agent","type":"data","query":"fetch spans\n| filter traceloop.span.kind == \"task\"\n| summarize count(), by: {crewai.task.agent}","visualization":"pieChart","visualizationSettings":{"autoSelectVisualization":false},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"6":{"title":"Active Flows","type":"data","query":"fetch spans\n| filter isNotNull(flow_name)\n| summarize countDistinct(flow_name)","visualization":"singleValue","visualizationSettings":{"singleValue":{"labelMode":"none"},"autoSelectVisualization":false},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"7":{"title":"Flow Execution Log","type":"data","query":"fetch spans\n| filter isNotNull(flow_name)\n| filter in(flow_name, $FlowName)\n| filter span.name == \"Flow Execution\"\n| fieldsKeep trace.id, start_time, end_time, span.status_code, flow_name, service.name, duration\n//| fields `Flow Name` = flow_name\n//| dedup `Flow Name`\n","visualization":"table","visualizationSettings":{"table":{"hideColumnsForLargeResults":false},"autoSelectVisualization":false},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"8":{"title":"Tokens by type","description":"","type":"data","query":"fetch spans\n| filter isNotNull(crewai.crew.name)\n| filter in(crewai.crew.name, $CrewName)\n| fields crewai.crew.token_usage\n| parse crewai.crew.token_usage, \"'total_tokens=' INT:total_tokens SPACE 'prompt_tokens=' INT:prompt_tokens SPACE 'cached_prompt_tokens=' INT:cached_prompt_tokens SPACE 'completion_tokens=' INT:completion_tokens SPACE 'successful_requests=' INT:successful_requests\"\n| fieldsRemove crewai.crew.token_usage\n//| fields `Crew Name` = crewai.crew.name\n| summarize total_tokens = sum(total_tokens), prompt_tokens = sum(prompt_tokens), cached_prompt_tokens = sum(cached_prompt_tokens), completion_tokens = sum(completion_tokens), successful_requests = sum(successful_requests)","visualization":"categoricalBarChart","visualizationSettings":{"chartSettings":{"categoricalBarChartSettings":{"isCategoryLabelVisible":false,"groupMode":"grouped","layout":"vertical"}},"autoSelectVisualization":false},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"9":{"title":"Time Spent Per Crew (in progress)","type":"data","query":"fetch spans\n| filter isNotNull(crewai.crew.name)\n| filter in(crewai.crew.name, $CrewName)\n| summarize sum(duration), by: {crewai.crew.name}","visualization":"categoricalBarChart","visualizationSettings":{"chartSettings":{"categoricalBarChartSettings":{"layout":"vertical"}},"autoSelectVisualization":false},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"10":{"type":"markdown","content":"## Agent Statistics"},"11":{"type":"markdown","content":"![crewai logo](https://cdn.prod.website-files.com/66cf2bfc3ed15b02da0ca770/66d07240057721394308addd_Logo%20(1).svg)"},"12":{"title":"Active Flows","type":"data","query":"fetch spans\n| filter isNotNull(flow_name)\n| dedup flow_name\n| fields flow_name","visualization":"table","visualizationSettings":{"autoSelectVisualization":false},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"13":{"title":"Executions per Flow","type":"data","query":"fetch spans\n| filter isNotNull(flow_name)\n| filter in(flow_name, $FlowName)\n| filter span.name == \"Flow Execution\"\n| fields `Flow Name` = flow_name\n| summarize executions = count(), by: {`Flow Name`}\n","visualization":"table","visualizationSettings":{"table":{"hideColumnsForLargeResults":false},"autoSelectVisualization":false},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"14":{"type":"markdown","content":"## Flow Statistics\n\nDrilldown to individual traces: Right click trace.id and \"open with\" \"distributed tracing\""},"15":{"type":"markdown","content":"## Crew Statistics\n\nDrilldown to individual traces: Right click trace.id and \"open with\" \"distributed tracing\""},"16":{"title":"Executions per Crew","type":"data","query":"fetch spans\n| filter isNotNull(crewai.crew.name)\n| fields `Crew Name` = crewai.crew.name\n| summarize executions = count(), by: {`Crew Name`}","visualization":"table","visualizationSettings":{"table":{"hideColumnsForLargeResults":false},"autoSelectVisualization":false},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"17":{"title":"Crew Errors","type":"data","query":"fetch spans\n| filter isNotNull(crewai.crew.name)\n| filter in(crewai.crew.name, $CrewName)\n| filter span.status_code == \"error\"\n| fields span.status_code, crewai.crew.name\n| summarize count(), by: {crewai.crew.name}","visualization":"donutChart","visualizationSettings":{"autoSelectVisualization":false,"thresholds":[]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"18":{"title":"Flow Errors","type":"data","query":"fetch spans\n| filter isNotNull(flow_name)\n| filter in(flow_name, $FlowName)\n| filter span.name == \"Flow Execution\"\n| filter span.status_code == \"error\"\n| fields `Flow Name` = flow_name\n| summarize executions = count(), by: {`Flow Name`}\n","visualization":"table","visualizationSettings":{"table":{"hideColumnsForLargeResults":false},"autoSelectVisualization":false},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"19":{"title":"Token Usage per Agent","type":"data","query":"fetch spans\n| fields span.id, trace_id, span.name\n| join [\n    fetch spans\n    | filter isNotNull(gen_ai.usage.input_tokens)\n    | fields `span_id` = span.id, `parent_span_id` = span.parent_id, span.name, gen_ai.usage.input_tokens, gen_ai.usage.output_tokens, llm.usage.total_tokens\n], on: { left[span.id] == right[parent_span_id] }\n| fields `agent_name` = span.name, `input_tokens` = right.gen_ai.usage.input_tokens, `output_tokens` = right.gen_ai.usage.output_tokens, `total_tokens` = right.llm.usage.total_tokens\n| summarize `Input Tokens` = sum(input_tokens), `Output Tokens` = sum(output_tokens), `Total` = sum(total_tokens), by: {agent_name}","visualization":"table","visualizationSettings":{"autoSelectVisualization":true,"table":{"hideColumnsForLargeResults":true}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"20":{"type":"markdown","content":"## Token & Model Usage Statistics"},"21":{"type":"data","title":"Tokens by I/O type, system and response model","query":"timeseries { sum(gen_ai.client.token.usage), value.A = avg(gen_ai.client.token.usage, scalar: true) }, by: { gen_ai.token.type, gen_ai.system, gen_ai.response.model }","queryConfig":{"version":"18.0.1","subQueries":[{"id":"A","isEnabled":true,"datatype":"metrics","metric":{"key":"gen_ai.client.token.usage","aggregation":"sum"},"by":["gen_ai.token.type","gen_ai.system","gen_ai.response.model"],"filter":""}]},"subType":"dql-builder-metrics","visualization":"lineChart","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualizationSettings":{"autoSelectVisualization":true,"table":{"hideColumnsForLargeResults":true}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"22":{"type":"data","title":"Operation duration (avg. by model and op)","query":"timeseries { avg(gen_ai.client.operation.duration), value.A = avg(gen_ai.client.operation.duration, scalar: true) }, by: { gen_ai.system, gen_ai.response.model, gen_ai.operation.name }","queryConfig":{"version":"18.0.1","subQueries":[{"id":"A","isEnabled":true,"datatype":"metrics","metric":{"key":"gen_ai.client.operation.duration","aggregation":"avg"},"by":["gen_ai.system","gen_ai.response.model","gen_ai.operation.name"]}]},"subType":"dql-builder-metrics","visualization":"lineChart","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualizationSettings":{"autoSelectVisualization":true,"table":{"hideColumnsForLargeResults":true}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}}},"layouts":{"0":{"x":3,"y":0,"w":4,"h":2},"1":{"x":7,"y":0,"w":4,"h":2},"2":{"x":0,"y":21,"w":24,"h":5},"3":{"x":8,"y":35,"w":8,"h":6},"4":{"x":0,"y":35,"w":8,"h":6},"6":{"x":3,"y":2,"w":4,"h":2},"7":{"x":0,"y":28,"w":24,"h":3},"8":{"x":0,"y":8,"w":24,"h":4},"9":{"x":0,"y":18,"w":24,"h":3},"10":{"x":0,"y":31,"w":24,"h":1},"11":{"x":0,"y":0,"w":3,"h":4},"12":{"x":7,"y":2,"w":4,"h":2},"13":{"x":11,"y":2,"w":9,"h":2},"14":{"x":0,"y":26,"w":24,"h":2},"15":{"x":0,"y":16,"w":24,"h":2},"16":{"x":11,"y":0,"w":9,"h":2},"17":{"x":20,"y":0,"w":4,"h":2},"18":{"x":20,"y":2,"w":4,"h":2},"19":{"x":0,"y":32,"w":24,"h":3},"20":{"x":0,"y":4,"w":24,"h":1},"21":{"x":0,"y":5,"w":24,"h":3},"22":{"x":0,"y":12,"w":24,"h":4}},"importedWithCode":false,"settings":{}}
